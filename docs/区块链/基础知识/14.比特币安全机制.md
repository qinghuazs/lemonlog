---
title: æ¯”ç‰¹å¸å®‰å…¨æœºåˆ¶
date: 2025-09-30
permalink: /blockchain/bitcoin-security-mechanism.html
tags:
  - åŒºå—é“¾
  - æ¯”ç‰¹å¸
  - å®‰å…¨
  - æ”»å‡»é˜²å¾¡
categories:
  - åŒºå—é“¾
---

# æ¯”ç‰¹å¸å®‰å…¨æœºåˆ¶

## å®‰å…¨å¨èƒæ¦‚è§ˆ

```mermaid
mindmap
  root((æ¯”ç‰¹å¸å®‰å…¨å¨èƒ))
    ç½‘ç»œå±‚æ”»å‡»
      51%æ”»å‡»
      è‡ªç§æŒ–çŸ¿
      æ—¥èš€æ”»å‡»
      å¥³å·«æ”»å‡»
    äº¤æ˜“å±‚æ”»å‡»
      åŒèŠ±æ”»å‡»
      äº¤æ˜“å»¶å±•æ€§
      ç²‰å°˜æ”»å‡»
    ç”¨æˆ·å±‚å¨èƒ
      ç§é’¥æ³„éœ²
      é’“é±¼æ”»å‡»
      ç¤¾ä¼šå·¥ç¨‹
    ç³»ç»Ÿå±‚æ¼æ´
      è½¯ä»¶æ¼æ´
      åè®®ç¼ºé™·
      å®ç°é”™è¯¯
```

## ç½‘ç»œå±‚æ”»å‡»ä¸é˜²å¾¡

### 1. 51%æ”»å‡»

51%æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…æ§åˆ¶è¶…è¿‡50%çš„ç½‘ç»œç®—åŠ›ï¼Œä»è€Œèƒ½å¤Ÿæ“çºµåŒºå—é“¾ã€‚

```java
public class FiftyOnePercentAttack {

    // æ”»å‡»åœºæ™¯æ¨¡æ‹Ÿ
    public class AttackScenario {

        // 1. åŒèŠ±æ”»å‡»
        public void doubleSpendAttack() {
            System.out.println("=== 51%æ”»å‡»ï¼šåŒèŠ± ===\n");

            // æ­¥éª¤1ï¼šæ”»å‡»è€…æ”¯ä»˜ç»™å•†å®¶
            Transaction payment = new Transaction();
            payment.setFrom(attackerAddress);
            payment.setTo(merchantAddress);
            payment.setAmount(100_BTC);

            String txId = broadcastTransaction(payment);
            System.out.println("1. æ”»å‡»è€…å‘é€æ”¯ä»˜: " + txId);

            // æ­¥éª¤2ï¼šç­‰å¾…ç¡®è®¤
            waitForConfirmations(txId, 6);
            System.out.println("2. äº¤æ˜“è·å¾—6æ¬¡ç¡®è®¤");

            // æ­¥éª¤3ï¼šå•†å®¶å‘è´§
            merchant.shipGoods();
            System.out.println("3. å•†å®¶å‘è´§");

            // æ­¥éª¤4ï¼šæ”»å‡»è€…ç§˜å¯†æŒ–çŸ¿ï¼ˆä¸åŒ…å«paymentäº¤æ˜“ï¼‰
            List<Block> secretChain = new ArrayList<>();
            for (int i = 0; i < 7; i++) {
                Block secretBlock = mineBlockWithout(payment);
                secretChain.add(secretBlock);
            }
            System.out.println("4. æ”»å‡»è€…ç§˜å¯†æŒ–å‡º7ä¸ªåŒºå—");

            // æ­¥éª¤5ï¼šå¹¿æ’­ç§˜å¯†é“¾
            broadcastChain(secretChain);
            System.out.println("5. å¹¿æ’­ç§˜å¯†é“¾ï¼Œä¸»é“¾é‡ç»„");

            // æ­¥éª¤6ï¼špaymentäº¤æ˜“å›æ»š
            System.out.println("6. æ”¯ä»˜äº¤æ˜“è¢«å›æ»š");
            System.out.println("ç»“æœï¼šæ”»å‡»è€…æ‹¿å›100 BTCï¼Œå•†å®¶æŸå¤±è´§ç‰©");
        }

        // 2. å®¡æŸ¥æ”»å‡»
        public void censorshipAttack(String targetAddress) {
            System.out.println("=== å®¡æŸ¥æ”»å‡» ===\n");

            // æ”»å‡»è€…æ‹’ç»æ‰“åŒ…ç‰¹å®šåœ°å€çš„äº¤æ˜“
            while (controlsMajority()) {
                Block block = mineBlock();

                // è¿‡æ»¤ç›®æ ‡åœ°å€çš„äº¤æ˜“
                List<Transaction> filteredTxs = block.getTransactions()
                    .stream()
                    .filter(tx -> !tx.involvesAddress(targetAddress))
                    .collect(Collectors.toList());

                block.setTransactions(filteredTxs);
                broadcastBlock(block);

                System.out.println("åŒºå— " + block.getHeight() +
                                 ": æ’é™¤äº† " + targetAddress + " çš„äº¤æ˜“");
            }
        }
    }

    // æ”»å‡»æˆæœ¬åˆ†æ
    public class AttackCostAnalysis {

        public void calculateCost() {
            System.out.println("=== 51%æ”»å‡»æˆæœ¬åˆ†æ ===\n");

            // 2024å¹´æ•°æ®
            double networkHashRate = 600_000_000; // TH/s (600 EH/s)
            double attackHashRate = networkHashRate * 0.51;

            System.out.println("å…¨ç½‘ç®—åŠ›: " + networkHashRate + " TH/s");
            System.out.println("æ”»å‡»æ‰€éœ€: " + attackHashRate + " TH/s\n");

            // ç¡¬ä»¶æˆæœ¬
            double costPerTHs = 30; // USD (çŸ¿æœºä»·æ ¼ä¸‹é™)
            double hardwareCost = attackHashRate * costPerTHs;

            System.out.println("ã€ç¡¬ä»¶æˆæœ¬ã€‘");
            System.out.println("çŸ¿æœºä»·æ ¼: $" + costPerTHs + "/TH");
            System.out.println("æ€»æŠ•èµ„: $" + String.format("%,.0f", hardwareCost));
            System.out.println("çº¦: " + hardwareCost / 1_000_000_000 + " äº¿ç¾å…ƒ\n");

            // è¿è¥æˆæœ¬
            double powerPerTHs = 0.03; // kW
            double electricityRate = 0.05; // USD/kWh
            double hourlyPower = attackHashRate * powerPerTHs * electricityRate;

            System.out.println("ã€è¿è¥æˆæœ¬ã€‘");
            System.out.println("æ¯å°æ—¶ç”µè´¹: $" + String.format("%,.0f", hourlyPower));
            System.out.println("æ¯å¤©ç”µè´¹: $" + String.format("%,.0f", hourlyPower * 24));
            System.out.println("æ¯æœˆç”µè´¹: $" + String.format("%,.0f", hourlyPower * 24 * 30) + "\n");

            // æœºä¼šæˆæœ¬
            double btcPrice = 60_000;
            double blockReward = 3.125;
            double hourlyBlocks = 6;
            double opportunityCost = hourlyBlocks * blockReward * btcPrice * 0.51;

            System.out.println("ã€æœºä¼šæˆæœ¬ã€‘");
            System.out.println("æ¯å°æ—¶æŸå¤±æŒ–çŸ¿æ”¶å…¥: $" + String.format("%,.0f", opportunityCost));
            System.out.println("æ¯å¤©æŸå¤±: $" + String.format("%,.0f", opportunityCost * 24) + "\n");

            // æ€»æˆæœ¬
            double dailyCost = (hourlyPower + opportunityCost) * 24;
            System.out.println("ã€æ”»å‡»1å¤©æ€»æˆæœ¬ã€‘");
            System.out.println("$" + String.format("%,.0f", dailyCost));

            // æ”»å‡»åæœ
            System.out.println("\nã€æ”»å‡»åæœã€‘");
            System.out.println("- æ¯”ç‰¹å¸ä¿¡ä»»å´©æºƒ");
            System.out.println("- ä»·æ ¼æš´è·Œ");
            System.out.println("- çŸ¿æœºä»·å€¼å½’é›¶");
            System.out.println("- æ”»å‡»è€…æŸå¤±æœ€å¤§");
            System.out.println("\nç»“è®ºï¼šç»æµä¸Šä¸å¯è¡Œï¼");
        }
    }

    // é˜²å¾¡æœºåˆ¶
    public class DefenseMechanisms {

        // 1. æ£€æŸ¥ç‚¹ï¼ˆCheckpointsï¼‰
        public void checkpoints() {
            // Bitcoin Core å†…ç½®æ£€æŸ¥ç‚¹
            Map<Integer, String> checkpoints = Map.of(
                11111, "0000000069e244f73d78e8fd29ba2fd2ed618bd6fa2ee92559f542fdb26e7c1d",
                33333, "000000002dd5588a74784eaa7ab0507a18ad16a236e7b1ce69f00d7ddfb5d0a6",
                74000, "0000000000573993a3c9e41ce34471c079dcf5f52a0e824a81e7f953b8661a20",
                105000, "00000000000291ce28027faea320c8d2b054b2e0fe44a773f3eefb151d6bdc97"
            );

            // æ·±åº¦é‡ç»„ä¿æŠ¤
            int reorgLimit = 6;
            System.out.println("æ£€æŸ¥ç‚¹æœºåˆ¶é˜²æ­¢æ·±åº¦é‡ç»„");
            System.out.println("é‡ç»„æ·±åº¦é™åˆ¶: " + reorgLimit + " ä¸ªåŒºå—");
        }

        // 2. ç¡®è®¤ç­‰å¾…
        public void confirmationPolicy() {
            System.out.println("=== ç¡®è®¤ç­–ç•¥ ===\n");

            Map<String, Integer> policies = Map.of(
                "å°é¢äº¤æ˜“", 1,
                "ä¸­é¢äº¤æ˜“", 3,
                "å¤§é¢äº¤æ˜“", 6,
                "äº¤æ˜“æ‰€å……å€¼", 6,
                "äº¤æ˜“æ‰€æç°", 12
            );

            for (Map.Entry<String, Integer> entry : policies.entrySet()) {
                System.out.println(entry.getKey() + ": " +
                                 entry.getValue() + " æ¬¡ç¡®è®¤");
            }
        }

        // 3. ç®—åŠ›åˆ†å¸ƒç›‘æ§
        public void monitorHashRateDistribution() {
            Map<String, Double> poolDistribution = Map.of(
                "Foundry USA", 0.30,
                "Antpool", 0.20,
                "F2Pool", 0.15,
                "Binance Pool", 0.10,
                "Others", 0.25
            );

            System.out.println("=== ç®—åŠ›åˆ†å¸ƒ ===\n");
            for (Map.Entry<String, Double> entry : poolDistribution.entrySet()) {
                double percentage = entry.getValue() * 100;
                System.out.println(entry.getKey() + ": " + percentage + "%");

                if (entry.getValue() > 0.40) {
                    System.out.println("âš ï¸ è­¦å‘Šï¼šç®—åŠ›è¿‡äºé›†ä¸­ï¼");
                }
            }
        }
    }
}
```

### 2. è‡ªç§æŒ–çŸ¿ï¼ˆSelfish Miningï¼‰

```java
public class SelfishMining {

    // è‡ªç§æŒ–çŸ¿ç­–ç•¥
    public class SelfishStrategy {

        private List<Block> secretChain = new ArrayList<>();
        private int lead = 0; // é¢†å…ˆä¸»é“¾çš„åŒºå—æ•°

        public void execute() {
            System.out.println("=== è‡ªç§æŒ–çŸ¿ç­–ç•¥ ===\n");

            // åœºæ™¯1ï¼šæŒ–åˆ°æ–°åŒºå—
            if (minedNewBlock()) {
                Block block = getCurrentBlock();
                secretChain.add(block);
                lead++;

                System.out.println("æŒ–åˆ°åŒºå—ï¼Œä¿å¯†ã€‚é¢†å…ˆ: " + lead);
            }

            // åœºæ™¯2ï¼šå…¶ä»–çŸ¿å·¥æŒ–åˆ°åŒºå—
            if (othersMinedBlock()) {
                if (lead == 0) {
                    // æ— é¢†å…ˆä¼˜åŠ¿ï¼Œæ­£å¸¸ç«äº‰
                    System.out.println("æ— é¢†å…ˆï¼Œæ¥å—å¯¹æ–¹åŒºå—");
                } else if (lead == 1) {
                    // é¢†å…ˆ1ä¸ªï¼Œç«‹å³å‘å¸ƒ
                    System.out.println("é¢†å…ˆ1ä¸ªï¼Œç«‹å³å‘å¸ƒç§˜å¯†åŒºå—");
                    broadcastChain(secretChain);
                    // é€ æˆåˆ†å‰ï¼Œéƒ¨åˆ†ç®—åŠ›æµªè´¹
                } else {
                    // é¢†å…ˆ2+ä¸ªï¼Œå‘å¸ƒéƒ¨åˆ†ä¿æŒé¢†å…ˆ
                    System.out.println("é¢†å…ˆ" + lead + "ä¸ªï¼Œå‘å¸ƒ1ä¸ªåŒºå—");
                    broadcastBlock(secretChain.get(0));
                    secretChain.remove(0);
                    lead--;
                }
            }
        }

        // æ”¶ç›Šåˆ†æ
        public void analyzeProfit() {
            double hashPower = 0.30; // 30%ç®—åŠ›
            double normalRevenue = hashPower;
            double selfishRevenue = calculateSelfishRevenue(hashPower);
            double advantage = (selfishRevenue - normalRevenue) / normalRevenue * 100;

            System.out.println("\n=== æ”¶ç›Šåˆ†æ ===");
            System.out.println("ç®—åŠ›å æ¯”: " + (hashPower * 100) + "%");
            System.out.println("è¯šå®æŒ–çŸ¿æ”¶ç›Š: " + normalRevenue);
            System.out.println("è‡ªç§æŒ–çŸ¿æ”¶ç›Š: " + selfishRevenue);
            System.out.println("æ”¶ç›Šæå‡: " + String.format("%.2f", advantage) + "%");

            System.out.println("\né£é™©:");
            System.out.println("- å¯èƒ½æŸå¤±æ‰€æœ‰ç§˜å¯†åŒºå—");
            System.out.println("- ç½‘ç»œå‘ç°åå¯èƒ½è¢«ç¤¾åŒºæƒ©ç½š");
            System.out.println("- æŸå®³æ¯”ç‰¹å¸ä¿¡ä»»ï¼Œå¸ä»·ä¸‹è·Œ");
        }

        private double calculateSelfishRevenue(double alpha) {
            // Eyal & Sirer å…¬å¼
            double gamma = 0.5; // ç½‘ç»œè¿é€šæ€§å‚æ•°
            return alpha / (1 - alpha * (1 - alpha) * (4 * alpha + gamma * (1 - 2 * alpha)) - alpha * alpha);
        }
    }

    // é˜²å¾¡æªæ–½
    public class DefenseAgainstSelfish {

        // 1. éšæœºåŒºå—é€‰æ‹©
        public void randomBlockSelection() {
            System.out.println("é˜²å¾¡ï¼šéšæœºåŒºå—é€‰æ‹©ç­–ç•¥");
            System.out.println("- å½“å‡ºç°åˆ†å‰æ—¶ï¼Œéšæœºé€‰æ‹©æ¥å—å“ªä¸ªåŒºå—");
            System.out.println("- é™ä½è‡ªç§æŒ–çŸ¿çš„ä¼˜åŠ¿");
        }

        // 2. æ—¶é—´æˆ³éªŒè¯
        public boolean validateTimestamp(Block block) {
            long now = System.currentTimeMillis();
            long blockTime = block.getTimestamp();

            // åŒºå—æ—¶é—´ä¸èƒ½å¤ªè¶…å‰
            if (blockTime > now + 2 * 3600 * 1000) {
                System.out.println("åŒºå—æ—¶é—´è¿‡äºè¶…å‰ï¼Œæ‹’ç»");
                return false;
            }

            // åŒºå—æ—¶é—´å¿…é¡»å¤§äºä¸­ä½æ—¶é—´
            long medianTime = getMedianTimePast();
            if (blockTime <= medianTime) {
                System.out.println("åŒºå—æ—¶é—´å°äºä¸­ä½æ—¶é—´ï¼Œæ‹’ç»");
                return false;
            }

            return true;
        }

        // 3. å¿«é€ŸåŒºå—ä¼ æ’­
        public void fastBlockPropagation() {
            System.out.println("é˜²å¾¡ï¼šå¿«é€ŸåŒºå—ä¼ æ’­");
            System.out.println("- Compact Block Relay (BIP 152)");
            System.out.println("- FIBRE (Fast Internet Bitcoin Relay Engine)");
            System.out.println("- å‡å°‘ç½‘ç»œå»¶è¿Ÿï¼Œé™ä½è‡ªç§æŒ–çŸ¿ä¼˜åŠ¿");
        }
    }
}
```

### 3. æ—¥èš€æ”»å‡»ï¼ˆEclipse Attackï¼‰

```java
public class EclipseAttack {

    // æ”»å‡»è¿‡ç¨‹
    public class AttackProcess {

        public void executeAttack(Node targetNode) {
            System.out.println("=== æ—¥èš€æ”»å‡» ===\n");

            // æ­¥éª¤1ï¼šæ§åˆ¶ç›®æ ‡èŠ‚ç‚¹çš„è¿æ¥
            System.out.println("1. ç”¨æ¶æ„èŠ‚ç‚¹å¡«æ»¡ç›®æ ‡èŠ‚ç‚¹çš„è¿æ¥");

            List<Node> maliciousNodes = createMaliciousNodes(125);
            for (Node node : maliciousNodes) {
                targetNode.connect(node);
            }

            System.out.println("ç›®æ ‡èŠ‚ç‚¹çš„æ‰€æœ‰è¿æ¥å·²è¢«æ§åˆ¶");

            // æ­¥éª¤2ï¼šéš”ç¦»ç›®æ ‡èŠ‚ç‚¹
            System.out.println("\n2. éš”ç¦»ç›®æ ‡èŠ‚ç‚¹");
            targetNode.setIsolated(true);

            // æ­¥éª¤3ï¼šæä¾›è™šå‡ä¿¡æ¯
            System.out.println("\n3. æä¾›è™šå‡åŒºå—é“¾");

            // åˆ›å»ºä¼ªé€ çš„åŒºå—é“¾
            List<Block> fakeChain = createFakeChain();
            for (Block block : fakeChain) {
                targetNode.receiveBlock(block);
            }

            System.out.println("ç›®æ ‡èŠ‚ç‚¹æ¥å—äº†è™šå‡åŒºå—é“¾");

            // æ­¥éª¤4ï¼šåˆ©ç”¨éš”ç¦»
            System.out.println("\n4. åˆ©ç”¨éš”ç¦»çŠ¶æ€");
            System.out.println("- åŒèŠ±æ”»å‡»ç›®æ ‡èŠ‚ç‚¹");
            System.out.println("- é˜»æ­¢ç›®æ ‡èŠ‚ç‚¹çš„äº¤æ˜“å¹¿æ’­");
            System.out.println("- æµªè´¹ç›®æ ‡çŸ¿å·¥çš„ç®—åŠ›");
        }
    }

    // é˜²å¾¡æœºåˆ¶
    public class DefenseMechanisms {

        // 1. å¤šæ ·åŒ–è¿æ¥
        public void diversifyConnections() {
            System.out.println("=== é˜²å¾¡æªæ–½ ===\n");

            // è¿æ¥åˆ°ä¸åŒå­ç½‘
            List<String> subnets = List.of(
                "192.168.1.0/24",
                "10.0.0.0/8",
                "172.16.0.0/12"
            );

            System.out.println("1. è¿æ¥å¤šæ ·åŒ–");
            System.out.println("- è¿æ¥ä¸åŒIPå­ç½‘çš„èŠ‚ç‚¹");
            System.out.println("- é™åˆ¶åŒä¸€å­ç½‘çš„è¿æ¥æ•°");

            // éšæœºè¿æ¥ç«¯å£
            System.out.println("\n2. éšæœºç«¯å£");
            System.out.println("- ä½¿ç”¨éšæœºå‡ºç«™ç«¯å£");
            System.out.println("- ä½¿æ”»å‡»è€…éš¾ä»¥é¢„æµ‹");
        }

        // 2. æ£€æµ‹å¼‚å¸¸
        public void detectAnomalies(Node node) {
            System.out.println("\n3. å¼‚å¸¸æ£€æµ‹");

            // æ£€æŸ¥åŒºå—é“¾åˆ†å‰
            if (hasSuspiciousFork(node)) {
                System.out.println("âš ï¸ æ£€æµ‹åˆ°å¯ç–‘åˆ†å‰");
                alertUser(node);
            }

            // æ£€æŸ¥è¿æ¥æ¨¡å¼
            if (hasUnusualConnectionPattern(node)) {
                System.out.println("âš ï¸ è¿æ¥æ¨¡å¼å¼‚å¸¸");
                resetConnections(node);
            }

            // æ£€æŸ¥ç½‘ç»œå»¶è¿Ÿ
            if (hasHighLatency(node)) {
                System.out.println("âš ï¸ ç½‘ç»œå»¶è¿Ÿå¼‚å¸¸");
                seekNewPeers(node);
            }
        }

        // 3. é”šå®šè¿æ¥
        public void anchorConnections() {
            System.out.println("\n4. é”šå®šè¿æ¥ (BIP 155)");
            System.out.println("- ä¿æŒä¸å¯ä¿¡èŠ‚ç‚¹çš„é•¿æœŸè¿æ¥");
            System.out.println("- é‡å¯åè‡ªåŠ¨é‡è¿");
            System.out.println("- é˜²æ­¢è¢«å®Œå…¨éš”ç¦»");

            List<String> anchorPeers = List.of(
                "seed.bitcoin.sipa.be",
                "dnsseed.bluematt.me",
                "dnsseed.bitcoin.dashjr.org"
            );

            for (String peer : anchorPeers) {
                System.out.println("é”šå®šèŠ‚ç‚¹: " + peer);
            }
        }
    }
}
```

### 4. å¥³å·«æ”»å‡»ï¼ˆSybil Attackï¼‰

```java
public class SybilAttack {

    // æ”»å‡»å®ç°
    public void createSybilNodes() {
        System.out.println("=== å¥³å·«æ”»å‡» ===\n");

        // åˆ›å»ºå¤§é‡è™šå‡èŠ‚ç‚¹
        int numSybilNodes = 10000;
        List<Node> sybilNodes = new ArrayList<>();

        for (int i = 0; i < numSybilNodes; i++) {
            Node sybil = new Node();
            sybil.setId("Sybil-" + i);
            sybil.setIpAddress(generateFakeIP());
            sybilNodes.add(sybil);
        }

        System.out.println("åˆ›å»ºäº† " + numSybilNodes + " ä¸ªå¥³å·«èŠ‚ç‚¹");

        // æ”»å‡»ç›®æ ‡
        System.out.println("\næ”»å‡»ç›®æ ‡:");
        System.out.println("- æ§åˆ¶ç½‘ç»œæ‹“æ‰‘");
        System.out.println("- è¿›è¡Œæ—¥èš€æ”»å‡»");
        System.out.println("- å½±å“è·¯ç”±é€‰æ‹©");
    }

    // é˜²å¾¡æœºåˆ¶
    public class SybilDefense {

        // 1. å·¥ä½œé‡è¯æ˜ï¼ˆè¿æ¥æˆæœ¬ï¼‰
        public void connectionProofOfWork() {
            System.out.println("=== é˜²å¾¡ï¼šè¿æ¥å·¥ä½œé‡è¯æ˜ ===\n");
            System.out.println("- å»ºç«‹è¿æ¥éœ€è¦ä¸€å®šè®¡ç®—é‡");
            System.out.println("- æé«˜åˆ›å»ºå¤§é‡èŠ‚ç‚¹çš„æˆæœ¬");
        }

        // 2. ä¿¡èª‰ç³»ç»Ÿ
        public class ReputationSystem {
            private Map<String, Integer> nodeScores = new HashMap<>();

            public void updateReputation(String nodeId, boolean goodBehavior) {
                int score = nodeScores.getOrDefault(nodeId, 0);

                if (goodBehavior) {
                    score += 1;
                } else {
                    score -= 10;
                }

                nodeScores.put(nodeId, score);

                // ä½åˆ†èŠ‚ç‚¹æ–­å¼€è¿æ¥
                if (score < -50) {
                    disconnectNode(nodeId);
                    banNode(nodeId);
                }
            }

            public void printReputations() {
                System.out.println("=== èŠ‚ç‚¹ä¿¡èª‰ ===");
                nodeScores.forEach((id, score) ->
                    System.out.println(id + ": " + score)
                );
            }
        }

        // 3. IPåœ°å€é™åˆ¶
        public void ipRestrictions() {
            System.out.println("\n=== IPé™åˆ¶ ===");
            System.out.println("- é™åˆ¶åŒä¸€IPçš„è¿æ¥æ•°");
            System.out.println("- é™åˆ¶åŒä¸€å­ç½‘çš„è¿æ¥æ•°");
            System.out.println("- ä¼˜å…ˆè¿æ¥ä¸åŒè‡ªæ²»ç³»ç»Ÿ(AS)çš„èŠ‚ç‚¹");
        }
    }
}
```

## äº¤æ˜“å±‚æ”»å‡»ä¸é˜²å¾¡

### 1. åŒèŠ±æ”»å‡»

```java
public class DoubleSpendAttack {

    // ä¸åŒç±»å‹çš„åŒèŠ±
    public class DoubleSpendTypes {

        // 1. é›¶ç¡®è®¤åŒèŠ±
        public void zeroConfirmationDoubleSpend() {
            System.out.println("=== é›¶ç¡®è®¤åŒèŠ± ===\n");

            // äº¤æ˜“1ï¼šæ”¯ä»˜ç»™å•†å®¶ï¼ˆä½æ‰‹ç»­è´¹ï¼‰
            Transaction tx1 = new Transaction();
            tx1.setTo(merchantAddress);
            tx1.setAmount(1_BTC);
            tx1.setFee(0.0001_BTC);

            broadcast(tx1);
            System.out.println("1. å‘å•†å®¶å‘é€äº¤æ˜“ï¼ˆä½è´¹ç”¨ï¼‰");

            // ç«‹å³å‘é€äº¤æ˜“2ï¼šæ”¯ä»˜ç»™è‡ªå·±ï¼ˆé«˜æ‰‹ç»­è´¹ï¼‰
            Transaction tx2 = new Transaction();
            tx2.setTo(attackerAddress);
            tx2.setAmount(1_BTC);
            tx2.setFee(0.001_BTC);  // 10å€æ‰‹ç»­è´¹
            tx2.setInputs(tx1.getInputs());  // ç›¸åŒè¾“å…¥ï¼

            broadcast(tx2);
            System.out.println("2. å‘ç½‘ç»œå‘é€å†²çªäº¤æ˜“ï¼ˆé«˜è´¹ç”¨ï¼‰");

            System.out.println("\nç»“æœï¼š");
            System.out.println("- çŸ¿å·¥ä¼˜å…ˆæ‰“åŒ… tx2ï¼ˆé«˜è´¹ç”¨ï¼‰");
            System.out.println("- tx1 æˆä¸ºæ— æ•ˆäº¤æ˜“");
            System.out.println("- å•†å®¶æŸå¤±");

            System.out.println("\né˜²å¾¡ï¼šå•†å®¶ç­‰å¾…è‡³å°‘1æ¬¡ç¡®è®¤");
        }

        // 2. Finneyæ”»å‡»
        public void finneyAttack() {
            System.out.println("\n=== Finneyæ”»å‡» ===\n");
            System.out.println("å‰æï¼šæ”»å‡»è€…æ˜¯çŸ¿å·¥");

            // æ­¥éª¤1ï¼šçŸ¿å·¥æŒ–å‡ºåŒ…å«tx1çš„åŒºå—ä½†ä¸å¹¿æ’­
            Transaction tx1 = createTransaction(attackerAddress, 1_BTC);
            Block secretBlock = mineBlock(tx1);
            System.out.println("1. æŒ–å‡ºåŒ…å«å›é€€äº¤æ˜“çš„åŒºå—ï¼ˆä¸å¹¿æ’­ï¼‰");

            // æ­¥éª¤2ï¼šç”¨ç›¸åŒè¾“å…¥æ”¯ä»˜ç»™å•†å®¶
            Transaction tx2 = createTransaction(merchantAddress, 1_BTC);
            tx2.setInputs(tx1.getInputs());
            broadcast(tx2);
            System.out.println("2. å‘å•†å®¶å‘é€å†²çªäº¤æ˜“");

            // æ­¥éª¤3ï¼šå•†å®¶çœ‹åˆ°tx2ï¼Œå‘è´§
            System.out.println("3. å•†å®¶çœ‹åˆ°äº¤æ˜“ï¼Œå‘è´§");

            // æ­¥éª¤4ï¼šå¹¿æ’­ç§˜å¯†åŒºå—
            broadcast(secretBlock);
            System.out.println("4. å¹¿æ’­ä¹‹å‰æŒ–å¥½çš„åŒºå—");

            System.out.println("\nç»“æœï¼štx2æ— æ•ˆï¼Œtx1ç”Ÿæ•ˆ");
            System.out.println("é˜²å¾¡ï¼šç­‰å¾…å¤šæ¬¡ç¡®è®¤");
        }

        // 3. ç«æ€æ”»å‡»
        public void raceAttack() {
            System.out.println("\n=== ç«æ€æ”»å‡» ===\n");

            // å‘å•†å®¶å’Œç½‘ç»œåŒæ—¶å‘é€ä¸åŒäº¤æ˜“
            Transaction toMerchant = createTransaction(merchantAddress, 1_BTC);
            Transaction toSelf = createTransaction(attackerAddress, 1_BTC);
            toSelf.setInputs(toMerchant.getInputs());

            // å¹¶å‘å¹¿æ’­
            new Thread(() -> broadcast(toMerchant, merchantNode)).start();
            new Thread(() -> broadcast(toSelf, networkNodes)).start();

            System.out.println("å‘ä¸åŒèŠ‚ç‚¹åŒæ—¶å¹¿æ’­å†²çªäº¤æ˜“");
            System.out.println("å•†å®¶å¯èƒ½çœ‹åˆ° toMerchant");
            System.out.println("çŸ¿å·¥å¯èƒ½å…ˆæ”¶åˆ° toSelf");

            System.out.println("\né˜²å¾¡ï¼š");
            System.out.println("- è¿æ¥å¤šä¸ªèŠ‚ç‚¹");
            System.out.println("- ç›‘æ§åŒèŠ±äº¤æ˜“");
            System.out.println("- ç­‰å¾…ç¡®è®¤");
        }
    }

    // é˜²å¾¡ç­–ç•¥
    public class DoubleSpendDefense {

        public void implementDefense() {
            System.out.println("=== åŒèŠ±é˜²å¾¡ç­–ç•¥ ===\n");

            // 1. ç¡®è®¤ç­–ç•¥
            System.out.println("1. ç¡®è®¤ç­‰å¾…ç­–ç•¥");
            Map<String, Integer> confirmationPolicy = Map.of(
                "å°é¢ (<$100)", 1,
                "ä¸­é¢ ($100-$1000)", 3,
                "å¤§é¢ (>$1000)", 6
            );

            confirmationPolicy.forEach((range, confirmations) ->
                System.out.println("   " + range + ": " + confirmations + " ç¡®è®¤")
            );

            // 2. åŒèŠ±ç›‘æ§
            System.out.println("\n2. åŒèŠ±ç›‘æ§");
            System.out.println("   - ç›‘å¬ç›¸åŒè¾“å…¥çš„å†²çªäº¤æ˜“");
            System.out.println("   - å®æ—¶è­¦æŠ¥");

            // 3. æ›¿æ¢è´¹ç”¨ (RBF) æ£€æµ‹
            System.out.println("\n3. RBFæ£€æµ‹");
            System.out.println("   - æ£€æŸ¥äº¤æ˜“æ˜¯å¦æ ‡è®°RBF");
            System.out.println("   - RBFäº¤æ˜“éœ€è¦æ›´å¤šç¡®è®¤");
        }

        // åŒèŠ±æ£€æµ‹
        public boolean detectDoubleSpend(Transaction tx) {
            // è·å–äº¤æ˜“çš„æ‰€æœ‰è¾“å…¥
            List<TxInput> inputs = tx.getInputs();

            // æ£€æŸ¥å†…å­˜æ± ä¸­æ˜¯å¦æœ‰ä½¿ç”¨ç›¸åŒè¾“å…¥çš„äº¤æ˜“
            for (TxInput input : inputs) {
                List<Transaction> conflicts = mempool.findConflicts(input);

                if (!conflicts.isEmpty()) {
                    System.out.println("âš ï¸ æ£€æµ‹åˆ°åŒèŠ±å°è¯•ï¼");
                    System.out.println("å†²çªäº¤æ˜“: " + conflicts.get(0).getTxId());
                    return true;
                }
            }

            return false;
        }
    }
}
```

### 2. äº¤æ˜“å»¶å±•æ€§ï¼ˆTransaction Malleabilityï¼‰

```java
public class TransactionMalleability {

    // å»¶å±•æ€§é—®é¢˜
    public void demonstrateMalleability() {
        System.out.println("=== äº¤æ˜“å»¶å±•æ€§æ”»å‡» ===\n");

        // åŸå§‹äº¤æ˜“
        Transaction originalTx = new Transaction();
        originalTx.addInput(prevTxHash, 0);
        originalTx.addOutput(recipientAddress, 1_BTC);

        // ç­¾åäº¤æ˜“
        byte[] signature = sign(originalTx, privateKey);
        originalTx.setSignature(signature);

        String originalTxId = originalTx.getTxId();
        System.out.println("åŸå§‹äº¤æ˜“ID: " + originalTxId);

        // æ”»å‡»ï¼šä¿®æ”¹ç­¾åï¼ˆä¸æ”¹å˜æœ‰æ•ˆæ€§ï¼‰
        byte[] modifiedSignature = tweakSignature(signature);
        Transaction modifiedTx = originalTx.clone();
        modifiedTx.setSignature(modifiedSignature);

        String modifiedTxId = modifiedTx.getTxId();
        System.out.println("ä¿®æ”¹åäº¤æ˜“ID: " + modifiedTxId);

        System.out.println("\né—®é¢˜ï¼š");
        System.out.println("- äº¤æ˜“IDæ”¹å˜ï¼Œä½†äº¤æ˜“ä»ç„¶æœ‰æ•ˆ");
        System.out.println("- ç ´ååŸºäºTxIDçš„åº”ç”¨é€»è¾‘");
        System.out.println("- å½±å“æ”¯ä»˜é€šé“ç­‰Layer 2æ–¹æ¡ˆ");
    }

    // è§£å†³æ–¹æ¡ˆï¼šéš”ç¦»è§è¯ï¼ˆSegWitï¼‰
    public class SegWitSolution {

        public void explainSegWit() {
            System.out.println("\n=== SegWitè§£å†³æ–¹æ¡ˆ ===\n");

            System.out.println("æ ¸å¿ƒæ€æƒ³ï¼š");
            System.out.println("- å°†ç­¾åæ•°æ®ä»äº¤æ˜“IDè®¡ç®—ä¸­ç§»é™¤");
            System.out.println("- ç­¾åæ”¾åœ¨ç‹¬ç«‹çš„è§è¯(witness)å­—æ®µ");
            System.out.println("- äº¤æ˜“IDä»…åŸºäºéè§è¯æ•°æ®");

            System.out.println("\nSegWitäº¤æ˜“ç»“æ„ï¼š");
            System.out.println("1. äº¤æ˜“ID = hash(version + inputs + outputs + locktime)");
            System.out.println("2. è§è¯æ•°æ®å•ç‹¬å­˜å‚¨");
            System.out.println("3. ç­¾åä¿®æ”¹ä¸å½±å“äº¤æ˜“ID");
        }

        public Transaction createSegWitTx() {
            Transaction tx = new Transaction();
            tx.setVersion(2);
            tx.setFlag(0x0001);  // SegWitæ ‡å¿—

            // è¾“å…¥ï¼ˆä¸å«ç­¾åï¼‰
            TxInput input = new TxInput();
            input.setPrevTxHash(prevHash);
            input.setOutputIndex(0);
            input.setScriptSig(new byte[0]);  // ç©ºçš„ï¼
            tx.addInput(input);

            // è¾“å‡º
            TxOutput output = new TxOutput();
            output.setValue(1_BTC);
            output.setScriptPubKey(recipientScript);
            tx.addOutput(output);

            // è§è¯æ•°æ®ï¼ˆç­¾åï¼‰
            Witness witness = new Witness();
            witness.addData(signature);
            witness.addData(publicKey);
            tx.addWitness(witness);

            System.out.println("SegWitäº¤æ˜“åˆ›å»ºå®Œæˆ");
            System.out.println("äº¤æ˜“ID: " + tx.getTxId());
            System.out.println("è§è¯TxID: " + tx.getWTxId());

            return tx;
        }
    }
}
```

### 3. ç²‰å°˜æ”»å‡»ï¼ˆDust Attackï¼‰

```java
public class DustAttack {

    // ç²‰å°˜æ”»å‡»å®æ–½
    public void executeDustAttack() {
        System.out.println("=== ç²‰å°˜æ”»å‡» ===\n");

        System.out.println("ç›®æ ‡ï¼šå»åŒ¿ååŒ–æ¯”ç‰¹å¸ç”¨æˆ·");

        // å‘å¤§é‡åœ°å€å‘é€å¾®å°é‡‘é¢
        List<String> targetAddresses = collectAddresses(10000);
        long dustAmount = 546;  // æœ€å°é‡‘é¢

        System.out.println("\n1. å‘ " + targetAddresses.size() +
                         " ä¸ªåœ°å€å‘é€ç²‰å°˜");

        for (String address : targetAddresses) {
            Transaction dustTx = new Transaction();
            dustTx.addOutput(address, dustAmount);
            broadcast(dustTx);
        }

        System.out.println("2. ç›‘æ§è¿™äº›åœ°å€çš„åç»­äº¤æ˜“");
        System.out.println("3. å½“ç”¨æˆ·èŠ±è´¹ç²‰å°˜UTXOæ—¶ï¼š");
        System.out.println("   - ç²‰å°˜UTXOä¸ç”¨æˆ·å…¶ä»–UTXOåˆå¹¶");
        System.out.println("   - æš´éœ²åœ°å€å…³è”å…³ç³»");
        System.out.println("   - è¿›è¡Œåœ°å€èšç±»åˆ†æ");
    }

    // é˜²å¾¡æªæ–½
    public class DustDefense {

        // 1. ç²‰å°˜æ£€æµ‹
        public boolean isDust(long amount) {
            long dustLimit = 546;  // satoshis
            return amount < dustLimit;
        }

        // 2. ç²‰å°˜ç®¡ç†
        public void handleDust() {
            System.out.println("=== ç²‰å°˜é˜²å¾¡ ===\n");

            System.out.println("1. ä¸èŠ±è´¹ç²‰å°˜UTXO");
            System.out.println("   - é’±åŒ…è‡ªåŠ¨è¿‡æ»¤ç²‰å°˜");
            System.out.println("   - é¿å…å…³è”æš´éœ²");

            System.out.println("\n2. å¸æ§åˆ¶ï¼ˆCoin Controlï¼‰");
            System.out.println("   - æ‰‹åŠ¨é€‰æ‹©è¦èŠ±è´¹çš„UTXO");
            System.out.println("   - éš”ç¦»ç²‰å°˜UTXO");

            System.out.println("\n3. ç²‰å°˜æ•´åˆ");
            System.out.println("   - åœ¨é«˜éšç§ç¯å¢ƒä¸‹æ•´åˆ");
            System.out.println("   - ä½¿ç”¨CoinJoinæ··å¸");
        }

        // 3. åœ°å€éš”ç¦»
        public void addressIsolation() {
            System.out.println("\n4. åœ°å€éš”ç¦»ç­–ç•¥");
            System.out.println("   - æ¯æ¬¡æ¥æ”¶ä½¿ç”¨æ–°åœ°å€");
            System.out.println("   - é¿å…åœ°å€é‡ç”¨");
            System.out.println("   - ä½¿ç”¨HDé’±åŒ…");
        }
    }
}
```

## ç”¨æˆ·å±‚å®‰å…¨

### 1. ç§é’¥å®‰å…¨

```java
public class PrivateKeySecurity {

    // ç§é’¥å­˜å‚¨æ–¹æ¡ˆ
    public class StorageSolutions {

        // 1. çƒ­é’±åŒ…
        public void hotWallet() {
            System.out.println("=== çƒ­é’±åŒ… ===\n");

            System.out.println("ç‰¹ç‚¹ï¼š");
            System.out.println("- ç§é’¥åœ¨çº¿å­˜å‚¨");
            System.out.println("- æ–¹ä¾¿å¿«é€Ÿäº¤æ˜“");
            System.out.println("- å®‰å…¨æ€§è¾ƒä½");

            System.out.println("\nå®‰å…¨æªæ–½ï¼š");
            System.out.println("- åŠ å¯†ç§é’¥æ–‡ä»¶");
            System.out.println("- ä½¿ç”¨å¼ºå¯†ç ");
            System.out.println("- å®šæœŸå¤‡ä»½");
            System.out.println("- ä»…å­˜å‚¨å°é¢èµ„é‡‘");
        }

        // 2. å†·é’±åŒ…
        public void coldWallet() {
            System.out.println("\n=== å†·é’±åŒ… ===\n");

            System.out.println("ç‰¹ç‚¹ï¼š");
            System.out.println("- ç§é’¥ç¦»çº¿å­˜å‚¨");
            System.out.println("- æœ€é«˜å®‰å…¨æ€§");
            System.out.println("- ä½¿ç”¨ä¸ä¾¿");

            System.out.println("\nç±»å‹ï¼š");
            System.out.println("1. ç¡¬ä»¶é’±åŒ…");
            System.out.println("   - Ledger");
            System.out.println("   - Trezor");
            System.out.println("   - ColdCard");

            System.out.println("\n2. çº¸é’±åŒ…");
            System.out.println("   - æ‰“å°ç§é’¥å’Œåœ°å€");
            System.out.println("   - å®Œå…¨ç¦»çº¿");
            System.out.println("   - é˜²æ­¢ç‰©ç†æŸå");
        }

        // 3. å¤šç­¾é’±åŒ…
        public void multisigWallet() {
            System.out.println("\n=== å¤šç­¾é’±åŒ… ===\n");

            System.out.println("2-of-3å¤šç­¾ï¼š");
            System.out.println("- ç”Ÿæˆ3ä¸ªç§é’¥");
            System.out.println("- ä»»æ„2ä¸ªå³å¯ç­¾å");
            System.out.println("- åˆ†æ•£é£é™©");

            // åˆ›å»ºå¤šç­¾åœ°å€
            List<PublicKey> pubKeys = List.of(
                generateKey().getPublicKey(),
                generateKey().getPublicKey(),
                generateKey().getPublicKey()
            );

            String multisigAddress = createMultisig(2, pubKeys);
            System.out.println("\nå¤šç­¾åœ°å€: " + multisigAddress);

            System.out.println("\nå®‰å…¨ä¼˜åŠ¿ï¼š");
            System.out.println("- å•ä¸ªç§é’¥æ³„éœ²ä¸å½±å“èµ„é‡‘");
            System.out.println("- é˜²æ­¢å•ç‚¹æ•…éšœ");
            System.out.println("- é€‚åˆæœºæ„ç®¡ç†");
        }
    }

    // ç§é’¥æ¢å¤
    public class KeyRecovery {

        // BIP39åŠ©è®°è¯
        public void mnemonicRecovery() {
            System.out.println("\n=== BIP39åŠ©è®°è¯ ===\n");

            // ç”ŸæˆåŠ©è®°è¯
            String mnemonic = generateMnemonic(128);  // 12ä¸ªå•è¯
            System.out.println("åŠ©è®°è¯ï¼š");
            System.out.println(mnemonic);

            System.out.println("\nä»åŠ©è®°è¯æ¢å¤ï¼š");

            // åŠ©è®°è¯ -> ç§å­
            byte[] seed = mnemonicToSeed(mnemonic, "");

            // ç§å­ -> ä¸»ç§é’¥
            ExtendedKey masterKey = generateMasterKey(seed);

            // æ´¾ç”Ÿè·¯å¾„ m/44'/0'/0'/0/0
            ExtendedKey derivedKey = masterKey
                .derive(44 + 0x80000000)
                .derive(0 + 0x80000000)
                .derive(0 + 0x80000000)
                .derive(0)
                .derive(0);

            String address = derivedKey.getAddress();
            System.out.println("æ¢å¤çš„åœ°å€: " + address);
        }

        // Shamirå¯†é’¥åˆ†å‰²
        public void shamirSecretSharing() {
            System.out.println("\n=== Shamirå¯†é’¥åˆ†å‰² ===\n");

            String privateKey = "L3aB...";  // ç§é’¥

            // åˆ†å‰²æˆ5ä»½ï¼Œéœ€è¦3ä»½æ¢å¤
            List<String> shares = shamirSplit(privateKey, 3, 5);

            System.out.println("ç§é’¥å·²åˆ†å‰²æˆ5ä»½ï¼š");
            for (int i = 0; i < shares.size(); i++) {
                System.out.println("ä»½é¢ " + (i+1) + ": " + shares.get(i));
            }

            System.out.println("\næ¢å¤ç§é’¥ï¼ˆä½¿ç”¨ä»»æ„3ä»½ï¼‰ï¼š");
            List<String> selectedShares = shares.subList(0, 3);
            String recovered = shamirRecover(selectedShares);

            System.out.println("æ¢å¤çš„ç§é’¥: " + recovered);
            System.out.println("åŒ¹é…: " + recovered.equals(privateKey));
        }
    }
}
```

### 2. é’“é±¼é˜²æŠ¤

```java
public class PhishingProtection {

    // å¸¸è§é’“é±¼æ‰‹æ®µ
    public void commonPhishingTactics() {
        System.out.println("=== å¸¸è§é’“é±¼æ‰‹æ®µ ===\n");

        System.out.println("1. å‡å†’ç½‘ç«™");
        System.out.println("   - ä¼ªé€ äº¤æ˜“æ‰€ç½‘ç«™");
        System.out.println("   - ç›¸ä¼¼åŸŸå: coinbĞ°se.com (Ğ°æ˜¯è¥¿é‡Œå°”å­—æ¯)");
        System.out.println("   - çªƒå–ç™»å½•å‡­è¯");

        System.out.println("\n2. å‡å†’é’±åŒ…åº”ç”¨");
        System.out.println("   - ä»¿å†’çŸ¥åé’±åŒ…");
        System.out.println("   - åº”ç”¨å•†åº—ä¸Šæ¶");
        System.out.println("   - çªƒå–ç§é’¥/åŠ©è®°è¯");

        System.out.println("\n3. å‡å†’å®¢æœ");
        System.out.println("   - ç”µè¯/é‚®ä»¶è¯ˆéª—");
        System.out.println("   - è¦æ±‚æä¾›ç§é’¥");
        System.out.println("   - è¿œç¨‹ååŠ©æœ¨é©¬");

        System.out.println("\n4. å‰ªè´´æ¿åŠ«æŒ");
        System.out.println("   - æ¶æ„è½¯ä»¶ç›‘æ§å‰ªè´´æ¿");
        System.out.println("   - æ›¿æ¢æ¯”ç‰¹å¸åœ°å€");
        System.out.println("   - èµ„é‡‘å‘é€åˆ°æ”»å‡»è€…");
    }

    // é˜²æŠ¤æªæ–½
    public class ProtectionMeasures {

        public void implementProtection() {
            System.out.println("\n=== é˜²æŠ¤æªæ–½ ===\n");

            System.out.println("1. éªŒè¯ç½‘ç«™");
            System.out.println("   âœ… æ£€æŸ¥HTTPS");
            System.out.println("   âœ… æ£€æŸ¥åŸŸåæ‹¼å†™");
            System.out.println("   âœ… ä½¿ç”¨ä¹¦ç­¾");
            System.out.println("   âœ… å¯ç”¨2FA");

            System.out.println("\n2. éªŒè¯åº”ç”¨");
            System.out.println("   âœ… å®˜æ–¹æ¸ é“ä¸‹è½½");
            System.out.println("   âœ… éªŒè¯æ•°å­—ç­¾å");
            System.out.println("   âœ… æ£€æŸ¥è¯„ä»·å’Œä¸‹è½½é‡");

            System.out.println("\n3. è­¦æƒ•ç¤¾äº¤å·¥ç¨‹");
            System.out.println("   âŒ æ°¸è¿œä¸è¦åˆ†äº«ç§é’¥");
            System.out.println("   âŒ ä¸è¦ç›¸ä¿¡\"å®˜æ–¹å®¢æœ\"ä¸»åŠ¨è”ç³»");
            System.out.println("   âŒ ä¸è¦ç‚¹å‡»å¯ç–‘é“¾æ¥");

            System.out.println("\n4. åœ°å€éªŒè¯");
            System.out.println("   âœ… ä»”ç»†æ ¸å¯¹åœ°å€");
            System.out.println("   âœ… æ£€æŸ¥å‰åå‡ ä½");
            System.out.println("   âœ… å°é¢æµ‹è¯•è½¬è´¦");
        }

        // åœ°å€éªŒè¯å·¥å…·
        public boolean verifyAddress(String clipboardAddress,
                                    String displayedAddress) {
            // æ£€æŸ¥æ˜¯å¦å®Œå…¨åŒ¹é…
            if (!clipboardAddress.equals(displayedAddress)) {
                System.out.println("âš ï¸ è­¦å‘Šï¼šåœ°å€ä¸åŒ¹é…ï¼");
                System.out.println("å‰ªè´´æ¿: " + clipboardAddress);
                System.out.println("æ˜¾ç¤ºçš„: " + displayedAddress);
                return false;
            }

            // æ£€æŸ¥åœ°å€æ ¼å¼
            if (!isValidBitcoinAddress(clipboardAddress)) {
                System.out.println("âš ï¸ è­¦å‘Šï¼šåœ°å€æ ¼å¼æ— æ•ˆï¼");
                return false;
            }

            System.out.println("âœ… åœ°å€éªŒè¯é€šè¿‡");
            return true;
        }
    }
}
```

## æ€»ç»“

### å®‰å…¨æœ€ä½³å®è·µ

```java
public class SecurityBestPractices {

    public void printBestPractices() {
        System.out.println("=== æ¯”ç‰¹å¸å®‰å…¨æœ€ä½³å®è·µ ===\n");

        System.out.println("ã€ç½‘ç»œå®‰å…¨ã€‘");
        System.out.println("âœ… è¿è¡Œå…¨èŠ‚ç‚¹å¢å¼ºå®‰å…¨æ€§");
        System.out.println("âœ… ä½¿ç”¨å¤šä¸ªè¿æ¥èŠ‚ç‚¹");
        System.out.println("âœ… å®šæœŸæ›´æ–°è½¯ä»¶");
        System.out.println("âœ… ç›‘æ§ç½‘ç»œå¼‚å¸¸");

        System.out.println("\nã€äº¤æ˜“å®‰å…¨ã€‘");
        System.out.println("âœ… ç­‰å¾…è¶³å¤Ÿç¡®è®¤ï¼ˆ6æ¬¡ï¼‰");
        System.out.println("âœ… ä½¿ç”¨SegWitåœ°å€");
        System.out.println("âœ… ç›‘æ§åŒèŠ±æ”»å‡»");
        System.out.println("âœ… åˆç†è®¾ç½®æ‰‹ç»­è´¹");

        System.out.println("\nã€ç§é’¥å®‰å…¨ã€‘");
        System.out.println("âœ… ä½¿ç”¨ç¡¬ä»¶é’±åŒ…å­˜å‚¨å¤§é¢èµ„é‡‘");
        System.out.println("âœ… å¤‡ä»½åŠ©è®°è¯ï¼ˆçº¸è´¨ï¼Œå¤šåœ°ï¼‰");
        System.out.println("âœ… ä½¿ç”¨å¤šç­¾å¢å¼ºå®‰å…¨");
        System.out.println("âœ… æ°¸è¿œä¸è¦åˆ†äº«ç§é’¥");

        System.out.println("\nã€éšç§ä¿æŠ¤ã€‘");
        System.out.println("âœ… ä¸é‡ç”¨åœ°å€");
        System.out.println("âœ… ä½¿ç”¨HDé’±åŒ…");
        System.out.println("âœ… é¿å…ç²‰å°˜æ”»å‡»");
        System.out.println("âœ… è€ƒè™‘ä½¿ç”¨CoinJoin");

        System.out.println("\nã€ç”¨æˆ·è¡Œä¸ºã€‘");
        System.out.println("âœ… è­¦æƒ•é’“é±¼æ”»å‡»");
        System.out.println("âœ… éªŒè¯æ‰€æœ‰åœ°å€");
        System.out.println("âœ… å°é¢æµ‹è¯•è½¬è´¦");
        System.out.println("âœ… ä¿æŒè½¯ä»¶æ›´æ–°");
    }
}
```

---

**ç›¸å…³æ–‡æ¡£ï¼š**
- [æ¯”ç‰¹å¸å…±è¯†æœºåˆ¶è¯¦è§£](./12.æ¯”ç‰¹å¸å…±è¯†æœºåˆ¶è¯¦è§£.md)
- [æ¯”ç‰¹å¸é’±åŒ…æŠ€æœ¯å®ç°](./07.æ¯”ç‰¹å¸é’±åŒ…æŠ€æœ¯å®ç°.md)
- [æ¯”ç‰¹å¸éšç§æŠ€æœ¯](./19.æ¯”ç‰¹å¸éšç§æŠ€æœ¯.md)

å®‰å…¨æ˜¯ä½¿ç”¨æ¯”ç‰¹å¸çš„åŸºç¡€ï¼Œç†è§£å¨èƒå’Œé˜²å¾¡æœºåˆ¶è‡³å…³é‡è¦ï¼ğŸ”’